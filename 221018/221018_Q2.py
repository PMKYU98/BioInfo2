sInput1 = '''
4
4->CAAATCCC
4->ATTGCGAC
5->CTGCGCTG
5->ATGGACGA
6->4
6->5
'''

sInput2 = '''
128
128->ATAAGGAAACGAGTGCGTTCTTGCAAGGATCGACTGGCACTGTGCTATAGAACTATGAAGTACCCCACGAATCGCCTTTTTGCTCCTCGGCTTCTGAAACGATGGCATCCTATGCCTCACTAGTGGGAATAAGCCTGCGGCTGTAATCGCTGTGGAAGTCGCG
128->GACCGACCGTGGTTTCTTAGGCACGGGTAGCAAATAAATCGATTGGTTCTTGTAAGAAGTCCTGCCTTCGTTCTTCCGATGAAGACCCATGGAATTAGCTTGAAGACAAGAATGAGAGTGTTTAATTTTAGGCCGAATGGGTAGGTCCGACTAACGGATCTCA
129->GACAACTTGGCTCAATAATACATGATGGGAGATGGATAGGAGTGTAAATTTATATCGCTAGTGTAAAGAATGTGGGATCGGGAGAACGGAGGTACGTGATATGATCCTAGCGTAACCCGTTCCAATCAACTGACCGAGTTGGACATATTGACTACGCTGAATG
129->ACGACCGAGCACACAAGTAGGGTACGGCCAATGTGAGTTGCGGTGATAGCCAACGACCTTGGACGTGCGTTACTATACCAGCAAGATGACATTTTGTGGATGGTTCTTAAGGGACAACTTTCCTTATGAACTGGTTGAACGACAACGGCTGCTAATCGCAGAG
130->AGTTCGCTACACTGAGTCAGAACTGTGCCCGTACGGTCAGCTTCATAGCTCAACTCTGGGTCGGTTGCGGTATCTTATGTATGATCTGCCCTATAACACCGAGAGCGACAATCATTGGTTTAATCAAAAATCAGTTGACTCGTGGAAAGTCGATGTTCCCCTG
130->CGTAACTAGTTTGTCAAGCCCGGGTGGAGAAGTACACCCCTTAGTGCCGCCCTTGTCGCGTGTTCCGCTGATTATTCCCTGCAGACTAAGTACTCCTGAGATCCAGACTGCATATATATTGCCTCGAAGCTGGTGATTTAAATATGAGACGCATTGCTTCAAT
131->ATCATGAGGGTACCCACTAGGTCCCCCAGCTCGAGAGAACGGCGGGGTCAACAAACGACATCGGGCTGCGCGATACTATAGCACTATTGGAATTGTGTTCATCCGGTAAGATAACTATCTTATCCTATGATTTTTCCTACGTACGCAAGTACGTTATGTACGA
131->TGTTCGCATAGGCTTGCTATTAGGATGTTCGCCCCTATAAGTAGTTGATTGCGGGTAGGTTCCCTTTCTGCCCTGGGGGGGGCAGGATGCGTGGGTGCAGTCTCGCGGCGTACTATCTGGCACATATTGGGTACTTCCGCCTGTTGGCATATGGGATCCACTA
132->TCATACTACAGCTCTCGAGAAACAGGACTGACGATACGGGGCGCTTAGTCCAGCGTCTTAACCTTCTCACGTTCAACCGCCTGGGCCACAATATGTTAAGGCTGCTAAGACTGTGATCAACGACGCCGATGCGATTGCGACGTACAGTAGCTCGCTTGCGCGC
132->TCTGGCTCCCCTCCCGCTGCTCTAATTCACGCGGTTTCTAAAAGCCCCTTCAATCGATGGCCATACAGGACGTTATGTACAGGAAGCGCATGTGACTACTAAGGGAAGACCGATTCCGGAATTCAGGTTTCTCACAAGATGTGGTTTACATGAGCAGTCGCAC
133->ACGCGGTCGCTGAACGATGGGCCAACCTTGCAACGTTTTAGTTGACTCGTCAATCGTACGGGGCCTTGTGCGACCCCACTCCTTCTCCGGCATCGCCGATCGTGCTAAACGCCCGGCCTCGTACCTCGTGAATAGAACTAACCGTGTGTCATATAAGCCGGAA
133->TCAGCTACTATAAACGCTATTAGCCGCGGTATATGTAAACGTGATCTAAAGCTTAACGCCTATCTTGTCGGCTGACGCGCGGGAGGAGTCTGGCTGTTCGGAGTGAACTGTACGTGCCTCCGATGGGCGATTAAAGGTTTGAATATTATGGCCGACTATACAG
134->CGTTGCAAGCAACAGGCTCAGGCTGGCCCTTCCGACGTATGATGCTCAGATGCGAACGAGAGGGTTTCTTGTTACTTAACGGTTCGCAGTGGGTCGATCTCACTATCGCTCGGGCTTTCTGTACTCCTGAGTCACACGTACGAGTCGATTAATCTACGTACGT
134->CGAGGGGTTCGCGGGGGCATGTGTCATCTGCGCCACAACGCTTCGTACAAAAAATCAGCTAGCAGTCGTGGACGGCAGTACCCGTTTGCACTGCTCATTCCACGTTTTAATCATCTCCTCGTTCCGGTACAATGACACGGTGTGGAGGACCCTGCATATGAAA
135->TAGCAATTTTCACCCTGGGATCGAAGGCAGCTGTACGCCGGGAAGTGCCCAGCGCCTCACTACTCGACAACTGTAAACAATGACGCGTGACCTTGGACAAGAATATGCTCTGCGCGCGCTAAACCATGCGAGTACAGCAAGGCCTTCAGGATTCATCTAACGC
135->TGGATGTGGCAACAGTTGGGGGGGAAGGGTCTGCTGCTCAGTCTAGATAAACGAAACCAAGGATACAGTTTCCGAGCTATAGCTTGTTGGAGGGAAGTCGTTAACCAAAGTCTGGCAATTTTCATGTGAAGGAGGAATAGAGTTCTCTGAGGCCAGCTGCAAA
136->ACCAATAGAACAGATTGTTCACTACCCTTCCCCATGTCACACCGCCCTAATCCACGAGATAGCTATGGTGATCCCTCGTACTCGACCTCAGCCCCGCAGAACTGCTCAATTTTCAGAACGATCTAACACCTACTTCACAAGTAGGTTCTCCACAGCCATCGAT
136->CTCCGGTAGCTTGGTACAAGATTACCCCCTAAGAGCCCCAATATCAGTCTCTTCACATGTATTCAGCGCTCGCTCAACCATACCCTGTGCAGCTAATATCCACTCCCGAAGGACACGATATCCATTCACATCATCCAAGTACAGGACCAGGTTTACTGACCTC
137->CAGATCGTTGTTTATATTCCATGCCGCTCCTCCCACCTGGCCGGAAGTCTATCAGATGAAGTACAACAACCTAAACAATTGCTATCGTGAAGCTCAACCGCATTTGAGCACATAACACAGCATCCAGCCTGCGTGCTATGTTACACATTAACACACCACAGCT
137->TTGCTCATGTGCAACCTGATACCTGATCTTCACGGCGAGAGGTCCTGCCCATAGCTGGCGCCCACTGCTTGGTGCCGAAACACAAGCATCGTCACGGACCCTGTTATCACGGCCCGGGACCTAGGCATGTCTACCGCCCGCACGCTACATTTTAGGAGGGTGC
138->GCAAGCCCCTTACGCCCGTACTAGGCCCCGTTTTCTCTTATGTTCTAAACTTTTTAAGGCACTCCAATGCCGGAATGAAAATGCTGGCAGGATTGAGCATACCGCTTGTCGGAAATTGCCTGATGTTTCGTCCCCGGGATGGTCGCGGGCCTATTGACCGTTG
138->CTGCACTCCTCGCTGTAGCCTCCTACCTCCAAAGGAGTTCTACAACGTTTGGGCAAGACGCCAATCCGATGAATCTACGTATTCGGATCCTTAGGATTGCTGTCCAATCAATAATACATGTATGTTGGGCTCTTGATATCACGCAGTCACGCGTGGGAAGGTT
139->AACCATAATCCCTTCTCCTATAACATACCAATCACGCCTTGGAAGTAACACACTCATCACTGCCGTGTGCCAAAAACTAGCAGAGGATTCGGTTTTTAAGGCTTTTACCTACCCATTTAGCTGCAAACCGAAGGAGGTGGAATTGGCCGGCCTGCAACTGTGT
139->CGCGCGACGGTCTGTAGGGTTACTATTCAACGAGCCTCCCTCGCCACAACCCATCCGATAATTAGAAGGTTGAGTGTGAAGGTACTGATTGCTGGCACATATGCGCAGCGATTCGGGCCTTTTGCAAAACCTGGCGGGTTTAGCCTTTTTAATCGCCGGCGTG
140->GTGTTGCGGAGTCGCAACAGAGCGGACCGAGGCCCCGGCCCCGTACAACAGTGAGTAACTTTCTGCCCAATGGTCCCCGGTATTCGAGACAGTTGGTTAAGTCTCTTTTTTCAAATCGGCGTTTTCACGAACGGGAGACCTCTTTGAAGCGTGAGCATATGCT
140->CAGTATGGCGACGATACCCCGGCATCGCTTTGACAACCTGCCAGAGACGCCACCGTGGGCGGAAACTAGGTCTGGCAAAGGCTCTTCTTGGTGATTTACAGAGGTGAGTTGCTTTTATGTTTTTCCCCTTCGCCCTTAATAATTCTGTTCGAGCTTAACTCGA
141->GGATATTCTATTCATAAGCGACAAGAGATCACGACCCCTGCGGCACTAATCTTCCTCACTCAACCTTCTAAGGTTCCGCCGTAAGGCGCAGATAGAATACTTTAGCCGCGATTGGCGAAAGAATCGAACTGGTTTTGTACACGAAATTCCAAAGGTCGTACAA
141->ATATAGCGTATCTCCTGCCCATGTAACTCAGTGAAGAACCGTGTCGTTAGAACCGCGCTGGCGCTCCAATTGCTATCCGGGCATACCCTAGACCTAGCCGAATGGTACCCCGGTTCAACTTATTCTGACTGCTTATCTTGAGTCAGTGGCATCAGAGCTGCGT
142->GCGCACATCATGCGTGAACTGACCGCCCCCAGATTTCGGTGCTCGTCGTACAGGCAGGGGCCAGCGCAAGATACGAAAAATAGCGCCTATACCCCGAAGAAAAAACCTTTCCCTAAATAGGCGAGTTGCAGAAGACCTAAGCACCCGTACAGCTGATATTAAT
142->GCGGAGACGAAAGTTGAGTGGCTGACGTGGAAAACCAGGCTCCCTCTTGAGGCTGCGACATTTATACTGAATTGCCCAGTTTTTACATTCACTAAAAGATCCTTCGGCATAAGTGACCAGCTCTACGACGCTGATTATCTTCGCAGTCTCCGAATTGGCTCCA
143->AATAGACAAGAGAACTTTGCAATTACTTAGGGGAGCATGACTTCCCGTAATCCATCTCGAATTAGCCACTTCATGCCAATCTTGCGGCTCCCATTCTAAACCAGAGGCACCGACAAGCACTTCGTCTAGTTGGCGATAGTATATTATTCCCCAGAAATCAGTT
143->TTTATCATATGCTACCATCGTGGGAGGCTGCTAGTCAGCCTACAGCTTGTGCTATATACCCTGGTCTATTTTAGTGCTATGAGTGAGCGTGTGAGACTGGGCATTGCATTACAGCTCGAGGGTATCTACATGAACTTTGTATGGCCCCTAATGCCCATTCTCG
144->CGGTCCCGCCCGAACCTCAGTCACGACCACAATATGTTCGCCAAGGCACGATCAACCTTGCTGGCCGGGACCTCGCCTAGCGGCAGATTGTAGAGTGCGCTCCTCCGACATAGCTACATGGTCGGCGCTGGCGGTATTCACCAATACGTTGAAAAGGATGGAA
144->GCGCGTCTGCTAGGAACTGCGGACATAGGTGGAGACGTTGGGCTTACTGACTAAGTTACAGAGGCCCTAAGCCAAAGCAATTACTGTAAGCTCAATAATGTGATGATCAGGGGCCCAATTGAGTGCCCTCACCACCAAGCGTACGCAAAGGCTGGGATAAACT
145->GATCCTTAATGTGCGGCTCTTCCCCGATACAATGCCGAATTATCCGGGTTCTTCCAGTAGCGATCCCACCATATATCGGTGAAGATAATAGTTTGGAGTTGTCATTCATCTAGCAACTTACCTAGAGCGTCTTGAGGCGTTGCGCATGAGGGCGGGCAGACAA
145->GCCCTTGCAACGACCATTAATTTCGAATTCGCTCATACATCATGCGCTTAGCTTACCGACACGAACTCGTCTCTATTGACCAGACAATCGTTAGCCATCATCAAAGCTACACGTTCGCCAGCCAAATGGGTCGCGCTAACTGCTGAATTGAGGGGACAAACCC
146->GTCCACCTTAAGCATGTGGTGTGAAATCGTTAACGATCTAGAAATAGCACCTCAAAGAAGAGGAGCACGGTTCAGCTGACATCGCCCAATCATATTCTAACAACACACTTCTGATAATTGTGTGGTCCGTGGTCGGTTCGCCTGCAAGCATATGGGTTGAAAT
146->CCGTCTCATGTTGCCGCACATTATTTTAGTCCTAGTGGTTATTCATCAGAGGAAGCTTATAATATTTCCTATATGGCGTCAGTGTACGGGACGGCACTAGGTCTAGATGGACGCAATTCGATGCACTCGGCGGGGATAGGGTTCCTGGCTTAAACAGTGTAAC
147->GTAAAATGTATTTCGGCATTACCATAGAAGCTTTAAGCTCGCACGACCCCACACGGGGAACCACCATACTTACACCTCACATCTCATCTCCCATAAGGAGTTACCACGCGCAGCGCCCACCCACGCTCACTTTGGAAGTTGGCGATACCCATTATGTAAGTAC
147->CTTAGAGATCGTGCCTGTTTCGAGACCCTCAACGATACAATGAAGGCGCGCTTAGCATCGGTATAAGTTATGCATTATGAGCCCCTACTCTACTACGGGAGTAATGAAGAAATTTGATCTGAAATGAGGTCAAAATACGTAGCGGCGTTGCGTCTAGTCGAGA
148->CTTTTCGTAACCAACTTAAACGAATGACATCATTAGCCTCGCGCCCCTACCAGAGAGAAGTACAAACCTTAGCGTACGGATTATTACCTAAACGTATAGGGCAAATGCGTAACGGGTCACGGATTGGAATACATTATAGGTGTAAGCCTGGGAAAATCCTGCG
148->GATCTGACCGTCTCACTAAAGGTTATCCACCGTGGTCCCCAATTGCTTTCAGGGACATTGGGGGGAAAAGGGGATGCTCCTTATGGAGACTTTGATCTCTCCCGTGACCCCCGGTCTTTGCAAGAGTCCTGCATGTCTGCCGGTCGCGAATGGGCTGAATCAT
149->TAATGGTAATGCATATCGAAGTCACTTCAACAAAGAGCAAAAGGACTTGGACCGGTCACTCCCTGACTCAAATGGCACCGATCTCTGCCGGTGTCCTCACAGTGGAATGAGACAGCTCGCCTTGAACTAAATTGTAAGTGCAGTGACATATCCTCAAGAATTT
149->GTACTAAATTCAGTCCGTGGTACGGCCTCTTCATGACACGGCCAAACCGGCGGGCATATCTATTTGGAAAACATACCAACTCGTAAGATGGAATCCCGTCCACGTTAAGTGCAGTATTGTGATAACGAAACACTCTAGGACTTTTCAAGGTAGCAGGTGCATC
150->TGATGCGAACGCACTGTATCCAAACCGAGCCCTCCCTTTATTGAACTAGAGCACAGGTCCAAGGCCCCCCGACTCGTGTCTTGTGACATGGCGTTGGGGAAATCACGTTAGCCTGGTCCCAGCCCAATCCCGCCATCACCTGGATATGTCCACAGTCCAACAT
150->GCTACAATTACTCCACATAGTTTTCAAGGCCGCTAGAGCGTTAAACCTGACGACTCGAGGGCAGCCTTTTACAGCGAATATGGTTTAAGCCCGGCTTTACAATAAGCTCCTTCTTAGCTTCTACCAAGGTACAACGACTTTAATAAACAACAAGGAACCCACT
151->GCGCACGAGCTATTACAAAAACTATAATAAAGAAAGTACCCATACGCGCGGACGTTAACCGCGCTTATTACCCTGACGGTTACTTGTTTAGTAGCTCGCATGTTCTAGACGGCCAGAGACCAGAATTTCGTCACAGTATTAGGGAGCATTGCGGCCCGTATCT
151->CGAGCACTTTAACATAAGATCATCAGTCTCACTTTGTCAGATTTGCGCCGCAAAAAATCCTTACGTGGTGTGCAGAGAAATAATATCATATGCCTGGGAGGACAGGCCGCCTTACACCCTGTCAGCGACGTGAGAGTTGCCAGCAGTTGGAACGAAGCAGTGG
152->ATTTCTGAGTGAAAAGCATCCCAGATCAAAAATATATGACACTCCCGATGGTGTTCACAGGCTCGGACCGGCGATACGGTTGTAGCATGTGACAAGTTGAAAAGTCGCAGCGCGAGCTACTCGCTCTTGAGAGAATAAGTATTGGGTTCGATGTGTCTCACTT
152->TCATGGGACGAGAACAGTTGTGTAGATCTAAATGCTCCGCACCAGGGCATTTGACTAAACAGCCGGATCTTCATACCTCTCCGAGCCGCGTAGTCACTGTTATTCATTGGCGACTCCACGGAGCCCTATGCCAAGCGGGTAGGGCCGATTAGTGTCAGGAAAA
153->GGCCTTTACTCTCGTTTATCGAGTAGAATAGGTCGGAAAGTTGTACCTGGGCGAGATTAACGCAGGGTATGGTCCATCACTTAAACACCGGTCGACGACTGGCATGACGACAATCCGGTGTTTCTTTCCTCATTTCCGGGGGTTGACAGTGTTACAGCGCAGC
153->AGCACAGTTGCCATTGATCGAGCATGTTGTAGTTGCGCAACAGCCGGTCAATGTACCCATGGTAACTCGGATAAGCATCTACACTTCTTAAGTTTGGACTCGATTATATTTAGAAGAGGCTAATAGGCGTGGCAGTATCCATCGGTGCGAGTGAACTCCGGTT
154->GAAATAGGGCCTTCCAGGATGAGCAACGAACCGGGAGTCGGACCTGGGTGTATTTTGGACCGCACACCTCCTCTCGGCTCCGTTATGTGATAACGTCACTTACCGGCCTCACAGATACTCCTAGCGGCAGCTATCGAGGACTCGGGTCATGCTGTTGATATTG
154->ACCGTGTTGACAACTCATGGTAGAGTGCTCGACCTTGCCCTATCCCCTAGACGTGCGTGCGGGGTAATGACAAGCCCTCAGTGCCACCATACTCTCCCTGGCCGGCTAAATATCATAGACGTGCGGTTAAAGTGCCCATGTTAAGCTGTAAATTCCGCGTCGT
155->ATCAGGTGGTAGCACCCCACTACGGTTCTATAGCCCATTAAGTTACCCCAGATCTCATTCAGAGCCATGGGAACTACAGATAGACATAATATTCAACGTGGCGATTGCATCTACGGCTGATCTTAGCAAGAAGCATGACCGCTTAAATACAATTCTGGTTTCG
155->GTGAAGGCTCGAGTGCTGCGTCGTTTCGTAAATTCTGCTATTCCCGGTGGGTCCAAGTTGAGTACAGTTAGATATCCGACAAGATCGCGCCTGCTTATAGTCCGACTCTACGGACCTGGAGGCTCACGGATCAAGCTCACGGGTTGACCGTTATCAAGAGTAT
156->ACCAGATGCACATCTCAGTAGATGAAAACCTTCCTCTCCGTCGGGGCAATTCCAGATACAGACATACAAGCCGTAAAGCAAAGTCGGGGTGTTTAAAGCCCATGTGCGTCGACGTTAGCAAACGCGAATACTCCCGAGTCCCTGTGCAGTGTCCCCGATCTGT
156->CCAGTGGCGAAGGTGCAATTGGAAGCTCGGAATGGGGTGCGGCTGGTATAACACGTGTATATAAGCACCAAAGCATCCAAGATCACCCTATTGCGTGTACGCTATGCGTTTACCCACGCACGCCCCGATGTAATCTAGCGGGCCACAGACCTCAACACCGTTC
157->TTTGTGCCAACAGCCCATGCAAAAAGCCAAGAATAATTTCGATCCATTGTGTAGAGTAGATTGTCCTGTAAATCGAACGCACAGTGGGGTGTCCTGGTATAGTATCTTAGCCTAATATTAAACTACAGACGTGGAATTTGAAAGTCACTGCGCGAAATGAAAA
157->AGACAAGGAGCTCAGCCCGGCTGCCGATTTACTTACGATTAACAAAGGGCTTACTCCTAAGTCAGTGGTGAGCGCTGTTTGGATCCGGAGCTGAAGTGCACGCTACAGATGCACTTAGTCGCTAAGGTTGATTTGAGAACGAATCGACTGTGCAGCGTAAGCC
158->TAACGCTTAAGACACCAGTTGATTATAAGCCTACTACCCCTACATCAACTCAAGCCCAGAACTCTGCACGGCCGGGTGCCAGTACTAAAACGATTTGATATTAAATATGACATGGTTCAAGGGCAGCACTGCGTAAGGGCTCAATGCAGGTAGTCCAGGACAC
158->GGTGATGTTGTACGTGCGATTGAATGTGGATACCGCGTATCTATGCCAACAATTTGATAGTGCACCTATTGAAGTACATGACGCTCTGGTGAGTGCTCATCCTTCTCCAGCGCTTGCGACCTCGTGAGCCCTTTAAACGTTTTCCGGCTTTAACGAAATTAAA
159->CCCGCTCGTAATTTAGTTATGATTAGCAGCAATCATTCCGGAGTGATGCTGCGTTGAGTTGAGCAGCAAGACCCACTCGTCAAGAAACTCCCCTCCTCAGTAGGGCGTAGGATTAACCACTGTCCCGGGTAGCAAAGAAGTTCCCTTTCGTCATTTTGGGCTA
159->TGTGTGGTTCTCGCCGTGTGACACGAGAGCCTTTGTTGACAATACGTCCTAAACCGGCAATGGTCATGAATGTAAATCCCTAACACGGGTCCCGGACTGCAAGGAATTTAATTTTTTGCGAATAATCCACAAATTGGCTTGCTCCGCAAGATACCTTAGGCTG
160->GGATACCCGCCCTCCTGTTGACGGTGGGAATGACGTTGATGAAAACCAAACGGCCAGTCGTTATGTCATTAGTCACTAGGTTAGCATGGGGCTTTGGCATTAATTTCGCACTACTGTTACACATAGTCATTCGCATTAGGGAGGACCCCTCAACTGGACGAGA
160->GGGTTAGGACCAGTCTTCTGCACAACTGAATGTCAGCTGTCACAACGGCGTCTGTTAATACTAGGCCTGACTTCTCAACTTGTCCTGAAATCTAGTTAAAAATCGCCTACAAATATGACCCTTCGATCACCACAATAGGAAATCCAAAGACCGGTTGCCCCTG
161->TCAGCCTGACTGCGGTATAAAGATTGTAAAGCATGCGTTGGCAGAGCGAGTCCTCCTGTTTTCCGACTTCCTCTGACGCTTATATGGAGTGCGCGGCACACTAAGGACCTCATGAATCCTAGCTCAGCTTACTCTTGGATAAAATCGAGTATGCGCGCCAGTT
161->AATCTGCCTACGCTAGCAGTGGACGTGTTCGGCGCAAGTGACCCTCTACGGAAGTTCAATACTCCACGAAAGTACCGATGACTCGTGCGCACCAGGGCGCCAACAATTTAGTAGCGCTATGGTGTGCTCTAGAATGTTGTCGTGATAGTGATACCGGAGAGCA
162->ATGACCGGATGGACAGAACAGCGGGTGTTCGAACGCAGCAGACGCAAACCGAAGGACGATAAGGCACTCCTTGAATCCGCGTATCTTCATGGCATTCAGTTCGATGGGCCTCCACCCTATGCACAGTCTCGGTACGGATGTCAGATCTAACATCGCCCAGAAT
162->GCTGTCGATCTTCCCGTAGCACGAGGCAGTCTGTCCGTCCTCCGCGTTGTGGGCATGCGAACTTAATATAAAGCATATAGCTCCGTACGGTGGTGTGCTCAGCATGTCTGGTGCCGACTATACATGTTTAGTACTCATCCGTCACTGAAGTTACATTTGCTGC
163->GTCGCAATCAGGGTGGTCGTCAGAGACGAATTCCCCAACTGTCGCAGGCTACGACTCACACATACCCTAATGGGTTGTGGCCCTCACTCGTCTAATCTCTACTCCCGTTTACTGTTTTGGATACGAACAACGGAGAGTGACGTGGGGTCTGTACGAGCGTAGT
163->TTAATATGCCCGCTTTCTTGGGTCTACGTGCCTTGCCAGATAAGTAGCCTGCCCACCCAGGTCGGGTATGTCACTGTATCAAGCACGCTGGGGTCGGTACGGTGTCTTTGATACTCGGCTTATCTCCGGATTTTAGTTTCATCGGTTCTTCCTTGAACCCCCC
164->ACACTTTCCGTTAATCTATTCCTGAACTCCATATGGCTTACAGGCTGAAACTTGATACCGCTGTGGACAGCAACGTTGCTAGTAGTCCCGTACAGCGTTATCTGTTATGCGCGGTCAAGCCCGGTATCCAACAGCTGGTTTAGCCAAACGTTAAGTTTGTTAG
164->CCGCAACGGATGGTGACAGATCCTCGCAAGCACGAATTGCAGGACCAACCCAATATAGTATCGTATTAACTGGCCCTGACCTACTTGCTTCTCCTGATAGGCTCTCAATCTTGAGATGGAGCTACCCAGACTACTTCGGCTCGGGAGCTTGCCTTAGCCGAGT
165->ATCGAGCCCAGAGTCTTCCCATACCTATTGATTGTGGGACGAAGTCGGTGGGAGTTAGACATTTTCTCGGTTTGCTAGTGTCTAGGGGTCTACGACAAATCAAGCTCGTCGAGGCGGTAGTAACATAGGACAGTTATTCCCAACTTGACGCGCGAAACAGTTA
165->TGGCCCGGTAGTCCCGTGGTCACTCCGTTCATGTTCCGCTGCGGAGGTGGGTTCTCGGCATAAGTCATAACAGTTACTCCTATGGGGTTTGCCCCGAATCTAAGCAGGTACATTGCTTAGCCGGTATGTAAAGACCGGCCCAAGTTTGCCCTGACATCCCCTA
166->CAGTGAAAGCTAGTGCATCGAGAAGTCTGGACGTGCAGGACGCTCATTACGCATGGATGATCCTATCAGCATCCGTACACCGATGTTTCCTGCACATCTAGATCGCACGATGGTGCTTTTTGCTACTTCGATACGGTGCGAATCAAGTCTTTTTTGAACCATT
166->TCTGACGGGGTAGTGCATTCAGCTATCCTTTTGGATTCGTTAGGTAGCCCACCTGCGGAGGTCCCGAGAGCTCAATTTATGGGTATCTGCCGCGCTTGCAGATCGTTGCGCTCTGACAGGCCCCCAGGGCCTTACCGTTATTTTGCTTTTACAGCAGGGAGGG
167->AGGGTCTTACTAGAAGACCAACCAAGTCGTCATCGCATACCGGCTGACACACTCCCGCTCCGATAATGGTCACTGCCCTTGTAAACACATAAACTATCCCATGGTCTCTTGATATGTATGGAGTCTGCTCTCCCCTGTATTGAGTTCCAGTCCCGCTGTAATC
167->GCTCGTCTGGGCGACAGGTCTCCCCCGCGCGAAACTTGTTTTGGTGAGATGAATGACTCTTCGGTTACTCTCATGTCATTATTCGCCTACTAGCGGGCTTAGCCACGCTCAAAAGTAAATTCAAAGGATCCAGTTAAACGTCGTTTGCTTGTCCTGCCTGCCT
168->ATGTGACCTTGATAGTTAGTACGAGAGCTACATCTCGCAAATTTATGTCATCAGCCATGGCCGGTTGGTACAGTGTCATTGGTTAGCCTGCGCCTCGCTCGCTTTTTTTAAACGGGCTACTCCCGTCTTACGGCCCAATCTGTGCTAGCGATATCTGCTCACC
168->TATATTGCGATTTCCGGTCATAACCCGAAAAGCACGTGAGTACCGTACAAGCTGAAAAAGCTTTTCATCGTCCGTTGTTATCGGGTAGTGATGAAGGGTGCTACCCCTATTTTCGGTTGCCCACACAGATAAGGACTTCGCGCGCTATACGTACTGATCTCCC
169->ACGGACGCGCCCTGTCGATGCGGACATTTCGCATATGATTCGACTAGTTGAACGCCTTACATTATCCGCTCTCAGCTTAAGTCCGCTGCCGGTTACATGAGGACGGGCCCTGCTTCTTTCGTTTCTAAATTAACGAGACTAGAATACGATACGTAGGACGGTA
169->AGACACATCCCTTTGATAATGGATTCGTCAGACTTCGAGGTCGAGACAAAACATGCCCAGGGTGTGCATCGATGCAGTATCCCTTCTCGCTCGACATCATGTGTGCTGCTGTACTGAGGGTCCCTCATTGGGCCTGCTGCAATGCCTGGATTAATCACTCGGA
170->GCAATCCGAAAGCGAATGGTATCCTATCGTGGTTGCGAATTTTTGTAGTTGCTCTGACATCGTCCCTGTTCGCAGTCACCTATAATGGCAGGACGCCTCCTCAATCAGAGTCCCATACTAAATGTCAGGATCGGCAGGCAATTAGCCGGATTTACCTGTGACA
170->GTTGCGCTTCACCGCGTCAGATGGGCATAACAATCACGCTTCGCCCACCGACCTTGCTGACACGTTACGATACAAGTGGAGTACTTGGACCGCTGCATGTTCCACGGCGATTACTGCTTTTCCTGGCATAGCTAGCGCCTCTCGTGAGTCCGTAGTGTCGCCT
171->ATTCACGCGCACTCCGCCTTCCGCTTCGGTGCGCTGCTATGTCTTCACTCTGAGAGAGCATACGTTTTTGCAATCTCTAAAGTCGCTGTGCTAAAATCGATTAATTCGATGGGTCACACCTTAGCGCCCCACTTGATTAAGTCCCCCAGGTGTCTGGCGGTCC
171->GGACTTGGTGAGCCGGGCAAGGCGGATCAAGCTCACCCATGTACTGACGCTGCGTCTGAAGCGAGCTCTTGCGGTCAGAGGTAATTCCGGGTAGGAGTATTCGAGTATTCTTAGAAGCTGCGGCCACTTTACAAACTCAATAAGCACTCAACGGTGTTAGCAT
172->TGCTAATATTATTTCTATTGACATCAGATAATCATGCCTGGGGGTTTGGTACTTACAGTCGCTTCGGATAGGGTCCGTAAAATACCAAAGAGTCACTCAGCCCTGCGGTCCGGGTGCCGAGTATGGTTCCGTAAAGCAGGGGAGACATTCGAGTCCTTTAGTG
172->GCTTAGACAGCGCGCCTGGTAACAAATCATCACCCCAACGACTCGGCTTTCGAACCGGGGCGTTCGCCAACCCGAACTTTAACGACTCCACTGCGGGCTGGTGTCTGAAATCGTTTGTGGCTATTAGCATTCCATATCTGCTTCCCACATCAGTCTACAGATC
173->ATTCTTAATGCTAGATTTAGTTGATCATAAAGTACGTAGTCTGACCAAAAGCGAATACACCGCCAGGCATCGGTGAATCCGCGCACGACACAACGTCATTCGCAGGGGTGTCCGTAGATGCGAGCACTTCAGCCCCTTTCCAATGCCGCCCAGCTGTGGTCGT
173->CCCATGGTACAATTGATATTGGCTATGGCGCGGCTCATAAGCAGATATACGGCCCCCAGCATTAGTCCGTTGTGGTATCCACTACCAAAGTACGCGTCCCTGTTAAGCGGAGCTTGCAAATGCATAGTGTGAGTAAGGCTCGCTGTCCATTGCTGGTAGGTAA
174->CCCTGATTGGATCATTATGAGCTGTACACAAATTTGGCTAAGACGAATGCACGCCGACTGCGTCGTCCGTCTGAACACGGGTTCGTCGTTACAGCACTACCGCTATCGTAGAATTTTATCGATCCCCGTGTAGGGCGTGCTGGGGCTAATCCTAATTTATGAT
174->TGAGAGGATACCACATCCTGATAGTAGATTAACGCGGGTAGAAGCCTCCCTGTGCGTCTCTTACAATGCACTATTCCTTAGCTGTATGAACTGCGCGGGAGGAGTGGCTCGAAAGTCTCCGGACGTGCATCAAATATTGGACTGGACCTATTCTAACAGACTA
175->CGGACGGTTCATGGGCTTGGATCTCGTTCTTCCGGCCGGGTTATAGCAGGAGCGACATCCCGCTCAATTGCGCCCTAAATGGGTACGGTCCTAATAGAACGTCACTGGATTCTCGGACACGACAGACGGTTGAAATCGATACGCTATTCACCCTGTGCCAGGC
175->ATCGTCAGCATGTACTTACCTACTATGGTACTAGAACTATGCAGGGTAGTTAAACCGGTATATTAGACAAGATTATGTAATGCGACTTGCGACGGTCTCTACTACCGATCCTCGCCATATTGCACATGACTCAAGCTAGTAAGATAACGGTATCATTTTCGGT
176->CGAGACAAAAAATGCGACCTATCCTATGTAGAAACACGCTAACTGCCTACAAACGCCTATATGACTTCGAGGCGTTGGCACGTTGATACAAGTCCTAGAGCTTGGCGGCACTACTTCGGACCGGTCATGTTTGTGCCGTACAGCCCAATGAGGTACAGGGCGT
176->GTTGTAACTCTGCTCAGGCCTATGTGTGGGGGAAGTGAGCACTATCATGCGTAGCTAGAGCGGAAGTCGTCAGATCAAGCATTAACGCGCGGTCAGACAACGACCGTTCGACGGGAGCATTGACCACCACAAGTAAAGTCAGCAATGTAAATAACTGATTATT
177->CGTAGACGATTCGGGCTTCTCCTATGCCCTTTTTCGTGGCCCAGGCGATCCCATTGTGGTTTTTTGTACTGGCGGGGACAATAATCCAATGCGATAAGTGTTCACGACGGTCATAGGTGCCATAACCATAACACGTTATTCTTATATAAACCAGTATCAGCTA
177->GGAGTTGGGCGCCTGATGACAGTCCGTGCCAGGGGTCCACATAAACTGTGCTCGAGCTCCGGGTGTTTAGGGCCCAAGAATTCAGACGCTTGCAAGCGAACGCCCCTGGACCTGAGCGCAGACGCTGGTCTGGCGTGCCTGCTTCATCTGGGACTCGGGGGTG
178->CGTGCACGATGAGCACAGGGACGACGAATACAAAGTTATGTTTTGGATCGACCACATCTTCGTGTTGCCATAGCACCTCGCTATCACGTTCAGTGACTCAACCATATTCTATCGGCCTGTTATTTCTTACTTGAAGTAAGCGTGGAGTTGAATTAGTTAAAGC
178->TTCGACGAGCTTGTGAAACACTTAGAAACGGCAGAGCAGCGCAATCGTCTAGGAATCCGTGGGCTGATCGGCCAAAGCCAGAAGTGGTAACCCCGAGAGGCTGAACGACGTTTGATGTGAAACCGCATCGGGCCAAAACCGGAACACCGTACCACGAAGCTTA
179->CTATGCAATAATAGTCGTATGATATGTAGAGGTCAGGTACTCGGGTTCTAAGGCCACACTATTCATCGACGCGTAGTACGAGTCCGCATCATGGCGATATTTATGTGCGGGGCACTGTTAGACCTATGAAGGGTCGAGCCTACACATTTCGAGATACAATTGG
179->CTGCGACTTTGGATAGTGAGTACCACTTGATAGGATAAAGTTTTCGACGAGCAAACACCGCTAATGGCTAAGATATAAATCTTTTCTGGTCTACACGTGCTACACAGCACAGTGCATCTGTTCATGTACATATCACTTTACCGGACCCCCGAGCTGTAGAATG
180->ACTTTAACTTCGTGACCTGCAGTCCACTAATCCATAACCCCATCTCTGTCTACCGGGGGAAACACCTAGATTGTGTACAACGCACTCGTCCTAATATTTGATTCTGGTAGCTGGAGACTGCCGGACTCTCTGACATCCAACGTATTCGTCAGCGACGCGGCGC
180->GCACGGCTCAGGTTCCTTGGGGCCTAGCTAGATCGCCTGTAGTATCTTCGCTTATGGATCAATTGTATAGTCGGGACTCCTGTCTGACGCGAAGACGCCGTTACGAGGACTCTCGCGCGGAGCTAAGAGAAGATGCTGCGGTAACGACCTTGCCTCGGCCTGG
181->GCGATCGTGCAGAGGAAATAATTATTCTTATATTCGCGCCACCTGATTTGATAGTATGGGAGCATAACATTTCCGGACGACTCTGCACCCGCATACTCCGTGTGGCTTCGTACCCCTGTGTGCTCTCGAGGTGAGTTAACGCATCGTTCGACACCTAGGAACA
181->GGCACAGCGTCCCGCGGGGGCGGCTGTGGATTTTTGCTTATCCCGAAATAGGCCGCCTAGCCCCATCCCGCAGATATAGGTCTTAAACAAGCCACCCTGCTTGTCTAAAAACTGCTGGTATGATCGTACTTGTCTCGGACAGCGGCGCTGGCGAAAAGTGAAT
182->TCAGCGTCCAGTGTCGGTCAGCTGGAGCTATCACAGTGTAACACCATTTGTACACAGAGGACTGGCAGAAAGCTCGGAATGTTTGTCCTTTCGAAAGTCCAGATCTTTTGGTCGCCAGCGGTATTCGGTTCACTTACCTTAGTTAGGCCCCAACTTGGGACCT
182->ACTACAAGGTGACCTCGTTCTACGTACGTTGCGGCCCGGTGCTACGTTGGATGGAAGTATGGCCGACCAACGGCTGGGCGTACACCCTAATCATTACGCGTACCGACCCGGATCATCGAGGTCATCTTGGGCAGTTCCGACAGACCAACTGAGCTAGCTCTCC
183->AGTTGAACGTCGAGATTAAATTCTCTGAGGAGGCAGCAGATCGATTTGGAAGACGTCCAACGGAGGCCTGACCCATTCCACTCTCTTGCCCTCCTGTCAGGTTCAGTCCCTCGGTCCTAACTTATCACGTGAGCATCGGGGATTGTTCGCAAATTGGTGTATT
183->ACTAGTCGTTATGGTCCCGTGCGATAGTCCTGAGGTTTCGTGTAGTACCGCGTCATAATTCAGATGCGGCGATCTGTTAAAAGCCCTCCTATGTCTTTTTAGTGATTGGTGACCTGGAATGATAATAACGTCGCCGCCCTGCTTTTTCCAACGTTTCGGATTA
184->ACTGGCGCCCCGTGACCCCTCGGTACTCCTTTTGATATATTAAATTTCGATCAGGCATGGTGAATCATTACTGGCCGGACCGGGAAGAGTCCGCGGCAACTGTTGCTATTCCATGTCACATCTACTTGCGTAGCAATAACTACATGAATGGTTGCGAAACTGA
184->ACCTATTTGTAAAGGCCGACGGTGGGTGCGGGTATATAACTGCGAGGGTAAAAGGGCCGTGCGCAAGGACGTGAAAGTTGGAGGCGGATTAGGCTTGTGCCGCTGAGCTTGTGCTCGTTCCTCGCCCCAGTCATTTGCGAAAGACTCCGTTCGTTTACCCCCT
185->TCCGAGGCGAGTGTGACTGATAAAACAGCTCAGCCCCGACTGCCTTTACAACCACCTAAGGACCGAATCACAATGCTGTGCATCAGCACGTGTTTAGCTTAGTACATGAATAGATAATACGCAGGAGGTTAGATGAGGGGTAGGATATATATGTAGCCATTCC
185->AGCCATTAGGAGTAGTGCTCTTGTATCCGTAGTGGTTCAACCGTCTTGCAATCAAGGTACTGTTGCGTGCACTGCGGGATGCTAAAAAAGCAACATTAAAGTCAATGATTACTCGTTGTTCAGACACTAATATTTTCCCGCGATGATCAGTCATGAGCCTGCC
186->CCCAGCTCCCTGGCGGGAACACTTCTTAGCTCCGTTCCGGAAGATTCTTTCTTGGGGAAGTCAAAGCGTTGGTGAAGTCTATCGCAGGACTCTGCGCCCTAGAGATATTCTTCTGACGAAGGCGTCAGATCCAATGTAATCAACACCCTCATCGTGTCTCTCC
186->ACTCCACACGAAGATGGCCTGAGTATTGTATTTTGTGGTTGGTGATGGACGCGTGGGCAATTTAGTAGGACTCCTGGACCAAACAAACAGCAGTCATGTCGTGGACATCGGTCAATTGCTCTGTGGCTTGTATCCAGTAGGAGCGCCTCTCACTCCTCGGCCA
187->ACGTTAAGCAAGATCACTCCAATGGAGTATGTAACTCCAAGCCTGCACTCGTCTCTGTCGGGTACATCATCTCGAAATCCTACTGGAGCAAGGAAGTGCCCTCTGGGTAAGCGCATCGTGGACTAACGTCTTCCCGCTCGGCCATACTGCACGAAGCACCTCA
187->TTTAACGGTTACCACCAATGTCTCTCCGATACAGGGGAGGTGAATCGGCAGGACTTTCCAAAGCGTTGCACAGGAGATGCGGGGATAGTTGTCTAGATACGCTATCATACGCTAGGGGCCTGGCCTGGTTTCACCGCCGGGTTTTTCCATTTGTTGTTTCTGT
188->ACCTTATCAAGCACCCCAGTGACGCTGTCACCGCGAACATCTCTATCGCTGCGTGTTCAGAATAGGCCATCGAGGAATTTCCGGACGGAGAGACAATGGCGGGTACCTGGGTGTGCCAAATCAGAAAAAGAGCTGTCGGGTCTCTGTTAGGCCAAGGTTGCCG
188->CGTAAGGCACCGAGTCCAGCCAGGGGGGCTGCCACGAGCTATCCGAAGCCGGGAAATTGTCGGAAACAGTGGAATCTGGATCGCGTGTTCACGGGCCCGCATACACTTCTCGACAAAAGCTGAACACTCATTCGATAAAGCTCGGCGAAAACCGACAGGTATA
189->CAGGGATGTTTAATAGGGAGAAGGGACGTCTCGAGATTCAAAGTACGAACTGAAGATAGGATTGAACTTCCGGGTCACCACATGCCAACACCGTGCGTTCTTGCGGGAACTCCACCCCGAGCCATCAATATGGTTGTACGAGCCACGTAGTGCGTTGTATGCA
189->CTGCGGGCTTGGAGTGCGGTTCACACCGGGCAGGCAGAAGACCAACGAGCAGGCTGGAGACAACAAAGCCACCACGTTCTTTATTGGACACCTTGGAATGATGAATTTATGGTGATCGATTATTTCATCGCCACTTGGGGCGCTTACAGGATCCAACGTACCT
190->GCCATGCGACCCGTAAGTATTTAGATTTGATACACAGGCACTGCACGTAGTCTAGCTGCGCCTTCTTCTCTGATTTGGTGGCTGATAAACCCAGCTTATTCTTGAGACCGCGACGTGCCAAGCGTGTTACGGGCGTCCTTTTCCGCCGATATAGATTACTTTT
190->GTGCAAAAATCGTATTATGAGTGTCAGCGCGCTCTTCACGGGGCCGGATGTCCCCCCCTCTGAAGGGTTGATCTGATTCCCCTTGGATGGTCGAGCAAGTTCCGGAACGGATATGCAGATATATGTGGAAACTGCTATGGCGGAGATAAACATTGGTGTATTC
191->GGAGTAGGATGGCGACGGGATAAACATGACCTAAACGTGTGGTATGCCATCTGCTTCGCGTTTATAGTCTAAGCCGGTCCTACCTAACGGGAATGCGGTAAACAAGACAGAGCAAATGTTCTATGCAGTAGATCCCCTGTCCCCTTGTGTGACGGTTTGATGG
191->TGCCCGTCAGCGTACCGCTACCGGTGGAATTTAGCGGTGGTTCGCCTGACGCTTGTCACTGATAGCATAGGTCTGTAGGAATGTTGAGTTTATCCACAAGTACGCCCTATAAGTAAAACAACTGGATCCGGAAGCGGCGGTCGCGTTAGTTTTCCTGTAAAGA
192->183
192->141
193->187
193->132
194->128
194->137
195->191
195->144
196->146
196->167
197->161
197->135
198->134
198->162
199->157
199->139
200->129
200->143
201->138
201->151
202->133
202->147
203->166
203->174
204->175
204->149
205->140
205->180
206->182
206->170
207->160
207->185
208->165
208->154
209->153
209->152
210->159
210->171
211->150
211->169
212->178
212->173
213->179
213->148
214->168
214->131
215->181
215->158
216->190
216->176
217->164
217->155
218->142
218->172
219->189
219->186
220->145
220->130
221->136
221->156
222->177
222->188
223->163
223->184
224->214
224->211
225->197
225->213
226->203
226->206
227->198
227->215
228->217
228->210
229->205
229->222
230->212
230->208
231->200
231->194
232->195
232->199
233->204
233->201
234->221
234->218
235->223
235->219
236->193
236->209
237->220
237->202
238->196
238->192
239->207
239->216
240->225
240->230
241->224
241->237
242->236
242->227
243->229
243->228
244->238
244->231
245->239
245->226
246->235
246->233
247->234
247->232
248->247
248->244
249->243
249->241
250->246
250->242
251->240
251->245
252->249
252->248
253->250
253->251
254->252
254->253
'''

sInput = sInput1
BASES = ['A', 'C', 'G', 'T']
INF = 999899

def HAMMING(s1, s2):
    score = 0
    for i in range(len(s1)):
        if s1[i] != s2[i]: score += 1
    return score

def PRINT_TREE(tree):
    for edge in tree:
        print('%s->%s:%d' % (edge[0], edge[1], edge[2]))

def WRITE_TREE(tree):
    with open('221018/221018_Q2_output.txt', 'w') as f:
        for edge in tree:
            f.write('%s->%s:%d\n' % (edge[0], edge[1], edge[2]))

def ADD_EDGE(tree, st, ed, dist):
    tree.append((st, ed, dist))
    tree.append((ed, st, dist))

def PARSE(sInput):
    lines = sInput.strip().split('\n')
    n = int(lines[0])
    root = 0

    lstLeaves = []
    dicChildren = {}
    for l in lines[1:]:
        parent, child = int(l.split('->')[0]), l.split('->')[1]
        dicChildren.setdefault(parent, [])
        root = max(root, parent)
        if child.isdigit():
            dicChildren[parent].append(int(child))
        else:
            new = len(lstLeaves)
            lstLeaves.append(child)
            dicChildren[int(parent)].append(new)
        
    return n, len(lstLeaves[0]), root, lstLeaves, dicChildren

def RIPE_NODE(visited):
    global dicChildren
    for parent in dicChildren:
        if visited[parent]: continue
        else:
            child0, child1 = dicChildren[parent]
            if visited[child0] and visited[child1]: return parent
    
    return None

def DELTA(c1, c2):
    if c1 == c2: return 0
    else: return 1

def MAKE_RIPE(c0Score, c1Score):
    score = {}
    backtrack = {}

    for base in BASES:
        c0Scoremin, c0Basemin = INF, 'X'
        for c0base in c0Score:
            temp = c0Score[c0base] + DELTA(base, c0base)
            if temp < c0Scoremin: c0Scoremin, c0Basemin = temp, c0base

        c1Scoremin, c1Basemin = INF, 'X'
        for c1base in c1Score:
            temp = c1Score[c1base] + DELTA(base, c1base)
            if temp < c1Scoremin: c1Scoremin, c1Basemin = temp, c1base

        score[base] = c0Scoremin + c1Scoremin
        backtrack[base] = (c0Basemin, c1Basemin)
        
    return score, backtrack
        


def SMALL_PARSIMONY_CHAR(n, root, lstChar):
    visited = [False for _ in range(root+1)]
    
    dicScores = {}
    dicBacktrack = {}
    for node in range(root+1):
        dicScores.setdefault(node, {})
        if node < n:
            visited[node] = True
            for base in BASES:
                if lstChar[node] == base: dicScores[node][base] = 0
                else: dicScores[node][base] = INF
            dicBacktrack[node] = None
    
    while True:
        v = RIPE_NODE(visited)
        if v is None: break
        visited[v] = True

        dicScores[v], dicBacktrack[v] = MAKE_RIPE(dicScores[dicChildren[v][0]], dicScores[dicChildren[v][1]])

    return dicScores, dicBacktrack

def BACKTRACK(node, char, dicBacktrack, dicChar={}):
    global dicChildren

    dicChar[node] = char
    if node in dicChildren:
        child0, child1 = dicChildren[node]
        dicChar = BACKTRACK(child0, dicBacktrack[node][char][0], dicBacktrack, dicChar)
        dicChar = BACKTRACK(child1, dicBacktrack[node][char][1], dicBacktrack, dicChar)
    
    return dicChar

def TREE_CONSTRUCTION(node, dicString, tree):
    global dicChildren

    if node in dicChildren:
        sNode = dicString[node]
        child0, child1 = dicChildren[node]
        sChild0 = dicString[child0]
        sChild1 = dicString[child1]

        tree = TREE_CONSTRUCTION(child0, dicString, tree)
        tree = TREE_CONSTRUCTION(child0, dicString, tree)
        ADD_EDGE(tree, sNode, sChild0, HAMMING(sNode, sChild0))
        ADD_EDGE(tree, sNode, sChild1, HAMMING(sNode, sChild1))

    return tree


def SMALL_PARSIMONY(n, root):
    global lstLeaves

    dicString = {}
    finalscore = 0
    for node in range(root+1):
        dicString[node] = []
    
    for m in range(len(lstLeaves[0])):
        dicScores, dicBacktrack = SMALL_PARSIMONY_CHAR(n, root, [leave[m] for leave in lstLeaves])
        temp = BACKTRACK(root, min(dicScores[root], key=dicScores[root].get), dicBacktrack, {})
        finalscore += min(dicScores[root].values())

        for node in temp:
            dicString[node].append(temp[node])

    for k in dicString:
        dicString[k]= ''.join(dicString[k])

    tree = TREE_CONSTRUCTION(root, dicString, [])

    return finalscore, dicString, tree
        

n, m, root, lstLeaves, dicChildren = PARSE(sInput)
print('n: %d, m: %d, root: %d' % (n, m, root))
print(lstLeaves)
print(dicChildren)

finalscore, dicString, tree = SMALL_PARSIMONY(n, root)
print(finalscore)
for k in dicString:
    print('%d: %s' % (k, dicString[k]))
print(tree)
WRITE_TREE(tree)